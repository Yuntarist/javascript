<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>할일 리스트 (localStorage저장 2)</title>
    <script>
        document.addEventListener('DOMContentLoaded',()=>{
            const h1 = document.createElement('h1')
            const input = document.createElement('input')
            const btn1 = document.createElement('button')
            const btn2 = document.createElement('button')
            const div = document.createElement('div')
            const span2 = document.createElement('span')
            const value = []

            h1.innerHTML = '할일 목록'
            btn1.innerHTML = '추가 하기'
            btn2.innerHTML = '전부 제거 하기'

            document.body.append(h1,input,btn1,btn2,div)
            div.appendChild(span2)
            span2.innerHTML = localStorage.getItem('input') ?? '비었습니다.'

            btn1.addEventListener('click',(e)=>{
                const checkbox = document.createElement('input')
                const span1 = document.createElement('span')
                const btn3 = document.createElement('button')
                const div2 = document.createElement('div')
                checkbox.setAttribute('type','checkbox')
                span1.innerHTML = input.value
                btn3.innerHTML = '삭제'
                div.append(checkbox,span1,btn3,div2)

                checkbox.addEventListener('change',(e)=>{
                    span1.style.textDecoration
                    = event.target.checked ? 'line-through' : ''
                })

                btn3.addEventListener('click',(e)=>{
                    span1.remove()
                    checkbox.remove()
                    btn3.remove()
                    div2.remove()
                })
                
                value.push(input.value)
                const value2 = JSON.stringify(value)
                localStorage.setItem('input',value2)
            })
            
            input.addEventListener('keyup',(e)=>{
                if(e.keyCode == 13){
                    const checkbox = document.createElement('input')
                    const span1 = document.createElement('span')
                    const btn3 = document.createElement('button')
                    const div2 = document.createElement('div')
                    checkbox.setAttribute('type','checkbox')
                    span1.innerHTML = input.value
                    btn3.innerHTML = '삭제'
                    div.append(checkbox,span1,btn3,div2)
                    
                    checkbox.addEventListener('change',(e)=>{
                        span1.style.textDecoration
                        = event.target.checked ? 'line-through' : ''
                    })

                    btn3.addEventListener('click',(e)=>{
                        span1.remove()
                        checkbox.remove()
                        btn3.remove()
                        div2.remove()
                    })
                    value.push(input.value)
                    const value2 = JSON.stringify(value)
                    localStorage.setItem('input',value2)
                }
            })
            btn2.addEventListener('click',(e)=>{
                localStorage.clear()
                input.value = ''
                span2.value.remove()
            })
        })
    </script>
</head>
<body>
    
</body>
</html>